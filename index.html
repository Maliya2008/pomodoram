<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Pomodoram - A free Pomodoro focus timer with task management, study music, and visual tree growth. Boost productivity with the Pomodoro Technique.">
    <meta name="keywords" content="pomodoro, focus timer, productivity, time management, study music, task list, pomodoro technique, pomodoram">
    <meta name="author" content="Pomodoram">
    <meta property="og:title" content="Pomodoram | Free Pomodoro Focus Timer with Study Music">
    <meta property="og:description" content="Boost your productivity with Pomodoram. A free Pomodoro timer featuring study music, task management, and beautiful tree growth visualization.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pomodoram.online">
    <meta name="twitter:card" content="summary_large_image">
    <title>Pomodoram | Free Pomodoro Focus Timer with Study Music & Task Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #10B981;
            --secondary: #3B82F6;
            --accent: #F59E0B;
            --focus: #10B981;
            --break: #3B82F6;
            --long-break: #8B5CF6;
            --dark-bg: #0F172A;
            --dark-card: #1E293B;
            --light-bg: #F8FAFC;
            --light-card: #FFFFFF;
            --nature-bg: linear-gradient(135deg, #065F46, #059669, #10B981);
            --text-dark: #1E293B;
            --text-light: #F1F5F9;
            --text-gray: #64748B;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --trunk-color: #8B4513;
            --tree-green-1: #2E7D32;
            --tree-green-2: #388E3C;
            --tree-green-3: #43A047;
            --tree-green-4: #4CAF50;
            --tree-green-5: #66BB6A;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-light);
            min-height: 100vh;
            padding: 10px;
            transition: var(--transition);
            overflow-x: hidden;
            -webkit-text-size-adjust: 100%;
        }

        body.light-theme {
            background: var(--light-bg);
            color: var(--text-dark);
        }

        body.nature-theme {
            background: var(--nature-bg);
            color: var(--text-light);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
            width: 100%;
        }

        /* Header - Optimized for mobile */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 0 5px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo i {
            color: var(--primary);
            font-size: 1.8rem;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            white-space: nowrap;
        }

        .header-controls {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: nowrap;
        }

        .theme-selector {
            display: flex;
            gap: 6px;
            background: rgba(255, 255, 255, 0.1);
            padding: 4px;
            border-radius: 10px;
            flex-shrink: 0;
        }

        body.light-theme .theme-selector {
            background: rgba(0, 0, 0, 0.05);
        }

        .theme-btn {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: var(--text-light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: var(--transition);
            flex-shrink: 0;
        }

        body.light-theme .theme-btn {
            color: var(--text-dark);
        }

        .theme-btn.active {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .fullscreen-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            flex-shrink: 0;
        }

        .fullscreen-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        /* Main Layout - Optimized for mobile */
        .main-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Timer Section - Mobile Optimized */
        .timer-section {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            width: 100%;
            min-height: auto;
        }

        body.light-theme .timer-section {
            background: rgba(255, 255, 255, 0.9);
        }

        body.nature-theme .timer-section {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Mode Selector - Mobile Optimized */
        .mode-selector {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 14px;
            padding: 4px;
            margin-bottom: 20px;
            width: 100%;
        }

        body.light-theme .mode-selector {
            background: rgba(0, 0, 0, 0.05);
        }

        .mode-btn {
            flex: 1;
            padding: 12px 8px;
            border: none;
            border-radius: 10px;
            background: transparent;
            color: var(--text-light);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            min-width: 0;
        }

        body.light-theme .mode-btn {
            color: var(--text-dark);
        }

        .mode-btn.active {
            background: white;
            color: var(--text-dark);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .mode-btn.focus.active { background: var(--focus); color: white; }
        .mode-btn.break.active { background: var(--break); color: white; }
        .mode-btn.long-break.active { background: var(--long-break); color: white; }

        /* Timer Display - Mobile Optimized */
        .timer-display-container {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto 25px;
            flex-shrink: 0;
        }

        @media (max-width: 360px) {
            .timer-display-container {
                width: 240px;
                height: 240px;
            }
        }

        @media (max-height: 700px) {
            .timer-display-container {
                width: 220px;
                height: 220px;
            }
        }

        .timer-display {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 3px solid var(--focus);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 
                inset 0 0 40px rgba(0, 0, 0, 0.2),
                0 20px 50px rgba(0, 0, 0, 0.2);
            transition: border-color 0.5s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .timer-display.break { border-color: var(--break); }
        .timer-display.long-break { border-color: var(--long-break); }

        .time {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--text-light);
            margin-bottom: 8px;
            font-variant-numeric: tabular-nums;
            z-index: 2;
            position: relative;
            text-align: center;
            line-height: 1;
        }

        body.light-theme .time {
            color: var(--text-dark);
        }

        @media (max-width: 360px) {
            .time {
                font-size: 2.8rem;
            }
        }

        .timer-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 2;
            position: relative;
            margin-bottom: 8px;
            text-align: center;
        }

        body.light-theme .timer-label {
            color: var(--text-dark);
        }

        .session-info {
            color: var(--text-gray);
            font-size: 0.9rem;
            z-index: 2;
            position: relative;
            text-align: center;
        }

        /* Tree Visualization - Mobile Optimized */
        .tree-container {
            position: absolute;
            width: 160px;
            height: 160px;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: flex-end;
            justify-content: center;
            z-index: 1;
            pointer-events: none;
        }

        @media (max-width: 360px) {
            .tree-container {
                width: 140px;
                height: 140px;
                bottom: 30px;
            }
        }

        .tree {
            position: relative;
            width: 100px;
            height: 130px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
        }

        .trunk {
            width: 12px;
            height: 40px;
            background: var(--trunk-color);
            border-radius: 3px;
            position: relative;
            z-index: 1;
            box-shadow: 
                inset 2px 0 0 rgba(255, 255, 255, 0.1),
                inset -2px 0 0 rgba(0, 0, 0, 0.3),
                0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .trunk:before {
            content: '';
            position: absolute;
            top: 0;
            left: 3px;
            right: 3px;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            border-radius: 2px;
        }

        .tree-layer {
            position: absolute;
            border-radius: 50% 50% 40% 40%;
            opacity: 0;
            transform: scale(0);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 2;
            box-shadow: 
                inset 0 0 15px rgba(0, 0, 0, 0.3),
                0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .tree-layer.active {
            opacity: 1;
            transform: scale(1);
        }

        .tree-layer-1 {
            width: 120px;
            height: 45px;
            bottom: 40px;
            background: radial-gradient(circle at 50% 100%, var(--tree-green-1), #1B5E20);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .tree-layer-2 {
            width: 105px;
            height: 40px;
            bottom: 75px;
            background: radial-gradient(circle at 50% 100%, var(--tree-green-2), #2E7D32);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.25));
        }

        .tree-layer-3 {
            width: 90px;
            height: 35px;
            bottom: 110px;
            background: radial-gradient(circle at 50% 100%, var(--tree-green-3), #388E3C);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
        }

        .tree-layer-4 {
            width: 75px;
            height: 30px;
            bottom: 140px;
            background: radial-gradient(circle at 50% 100%, var(--tree-green-4), #43A047);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15));
        }

        .tree-layer-5 {
            width: 60px;
            height: 25px;
            bottom: 165px;
            background: radial-gradient(circle at 50% 100%, var(--tree-green-5), #4CAF50);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }

        .tree-top {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 15px solid #2E7D32;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 3;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .tree-top.active {
            opacity: 1;
            transform: translateY(0);
            bottom: 195px;
        }

        /* Progress Ring */
        .progress-ring {
            position: absolute;
            top: -3px;
            left: -3px;
            width: calc(100% + 6px);
            height: calc(100% + 6px);
            transform: rotate(-90deg);
            z-index: 2;
        }

        .progress-ring circle {
            fill: transparent;
            stroke-width: 3;
            stroke-linecap: round;
        }

        .progress-ring-bg {
            stroke: rgba(255, 255, 255, 0.1);
        }

        .progress-ring-fill {
            stroke: var(--primary);
            stroke-dasharray: 880;
            stroke-dashoffset: 880;
            transition: stroke-dashoffset 1s linear;
        }

        /* Timer Controls - Mobile Optimized */
        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 14px 20px;
            border: none;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            min-width: 100px;
            justify-content: center;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .start-btn {
            background: linear-gradient(135deg, var(--primary), #34D399);
            color: white;
        }

        .pause-btn {
            background: linear-gradient(135deg, var(--secondary), #60A5FA);
            color: white;
        }

        .skip-btn {
            background: linear-gradient(135deg, var(--accent), #FBBF24);
            color: white;
        }

        .control-btn:disabled {
            background: var(--text-gray);
            cursor: not-allowed;
            transform: none !important;
            opacity: 0.5;
        }

        /* Stats and Tasks Grid - Mobile Optimized */
        .stats-tasks-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 14px;
            padding: 15px;
            text-align: center;
            transition: var(--transition);
            min-height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        body.light-theme .stat-card {
            background: rgba(0, 0, 0, 0.03);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .stat-card:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
            margin-bottom: 6px;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        /* Tasks Preview - Mobile Optimized */
        .tasks-preview {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 14px;
            padding: 18px;
            transition: var(--transition);
        }

        body.light-theme .tasks-preview {
            background: rgba(0, 0, 0, 0.03);
        }

        .tasks-preview:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .tasks-preview:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .tasks-preview-title {
            font-size: 1.1rem;
            margin-bottom: 12px;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        body.light-theme .tasks-preview-title {
            color: var(--text-dark);
        }

        .tasks-preview-list {
            list-style: none;
            max-height: 150px;
            overflow-y: auto;
            margin: 0;
            padding: 0;
        }

        .tasks-preview-list::-webkit-scrollbar {
            width: 3px;
        }

        .tasks-preview-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
        }

        .tasks-preview-list::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 2px;
        }

        .task-preview-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        body.light-theme .task-preview-item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .task-preview-item:last-child {
            border-bottom: none;
        }

        .task-preview-checkbox {
            width: 16px;
            height: 16px;
            margin-right: 10px;
            accent-color: var(--primary);
            cursor: pointer;
            flex-shrink: 0;
        }

        .task-preview-text {
            flex: 1;
            color: var(--text-light);
            font-size: 0.9rem;
            word-break: break-word;
            line-height: 1.3;
        }

        body.light-theme .task-preview-text {
            color: var(--text-dark);
        }

        .task-preview-text.completed {
            text-decoration: line-through;
            color: var(--text-gray);
        }

        .view-all-tasks {
            margin-top: 12px;
            text-align: center;
        }

        .view-all-btn {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .view-all-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Sidebar - Mobile Optimized */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Panels - Mobile Optimized */
        .panel {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        body.light-theme .panel {
            background: rgba(255, 255, 255, 0.9);
        }

        body.nature-theme .panel {
            background: rgba(255, 255, 255, 0.1);
        }

        .panel-title {
            font-size: 1.2rem;
            margin-bottom: 18px;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        body.light-theme .panel-title {
            color: var(--text-dark);
        }

        .panel-title i {
            color: var(--primary);
        }

        /* Settings - Mobile Optimized */
        .setting {
            margin-bottom: 18px;
        }

        .setting label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-light);
            font-size: 0.95rem;
        }

        body.light-theme .setting label {
            color: var(--text-dark);
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider-container input[type="range"] {
            flex: 1;
            height: 5px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
            -webkit-appearance: none;
        }

        body.light-theme .slider-container input[type="range"] {
            background: rgba(0, 0, 0, 0.1);
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .value-display {
            min-width: 35px;
            text-align: center;
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .auto-apply {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        body.light-theme .auto-apply {
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .auto-apply input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--primary);
        }

        .auto-apply label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        body.light-theme .auto-apply label {
            color: var(--text-dark);
        }

        /* Alarm Sound Selector */
        .alarm-selector {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        body.light-theme .alarm-selector {
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .alarm-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 12px;
        }

        .alarm-btn {
            padding: 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: transparent;
            color: var(--text-light);
            cursor: pointer;
            font-size: 0.85rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            white-space: nowrap;
        }

        body.light-theme .alarm-btn {
            color: var(--text-dark);
            border-color: rgba(0, 0, 0, 0.1);
        }

        .alarm-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .alarm-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        /* Music Panel - Spotify */
        .music-panel {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        body.light-theme .music-panel {
            background: rgba(255, 255, 255, 0.9);
        }

        body.nature-theme .music-panel {
            background: rgba(255, 255, 255, 0.1);
        }

        .spotify-player {
            width: 100%;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 15px;
        }

        /* Tasks Panel - Mobile Optimized */
        .task-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 18px;
        }

        .task-input {
            flex: 1;
            padding: 14px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-light);
            font-size: 0.95rem;
            outline: none;
            transition: var(--transition);
        }

        body.light-theme .task-input {
            background: white;
            border-color: #E2E8F0;
            color: var(--text-dark);
        }

        .task-input:focus {
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .task-input:focus {
            background: white;
        }

        .add-task-btn {
            padding: 0 16px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), #34D399);
            color: white;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .add-task-btn:hover {
            transform: scale(1.05);
        }

        .tasks-list {
            list-style: none;
            max-height: 250px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .tasks-list::-webkit-scrollbar {
            width: 4px;
        }

        .tasks-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
        }

        .tasks-list::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 2px;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 14px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-bottom: 10px;
            transition: var(--transition);
            border-left: 3px solid var(--primary);
        }

        body.light-theme .task-item {
            background: rgba(0, 0, 0, 0.03);
        }

        .task-item:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .task-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .task-item.completed {
            opacity: 0.7;
            border-left-color: var(--secondary);
        }

        .task-checkbox {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            accent-color: var(--primary);
            cursor: pointer;
            flex-shrink: 0;
        }

        .task-text {
            flex: 1;
            color: var(--text-light);
            font-size: 0.95rem;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: var(--transition);
            word-break: break-word;
            min-height: 22px;
            outline: none;
            line-height: 1.3;
        }

        body.light-theme .task-text {
            color: var(--text-dark);
        }

        .task-text.completed {
            text-decoration: line-through;
            color: var(--text-gray);
        }

        .task-text:focus {
            outline: 2px solid var(--primary);
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .task-text:focus {
            background: white;
        }

        .task-actions {
            display: flex;
            gap: 6px;
            opacity: 0;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .task-item:hover .task-actions {
            opacity: 1;
        }

        .task-action-btn {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            border: none;
            background: transparent;
            color: var(--text-gray);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .task-action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--primary);
        }

        body.light-theme .task-action-btn:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        /* Pomodoro Counter */
        .pomodoro-counter {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .pomodoro-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: var(--transition);
        }

        .pomodoro-dot.completed {
            background: var(--primary);
            transform: scale(1.2);
        }

        .pomodoro-dot.current {
            background: var(--secondary);
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 4px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }

        /* Progress Indicator */
        .progress-indicator {
            text-align: center;
            margin: 15px 0;
            color: var(--text-light);
        }

        body.light-theme .progress-indicator {
            color: var(--text-dark);
        }

        .time-progress {
            font-size: 1rem;
            font-weight: 600;
            margin-top: 8px;
        }

        /* Fullscreen Overlay - Optimized for Mobile */
        #fullscreen-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--dark-bg);
            z-index: 9999;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px;
            overflow: hidden;
        }

        #fullscreen-overlay.active {
            display: flex;
        }

        #fullscreen-overlay.light-theme {
            background: var(--light-bg);
        }

        #fullscreen-overlay.nature-theme {
            background: var(--nature-bg);
        }

        /* Fullscreen Exit Button - Mobile Optimized */
        .fullscreen-exit-btn {
            position: fixed;
            top: 15px;
            left: 15px;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            z-index: 10001;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: var(--transition);
        }

        .fullscreen-exit-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        #fullscreen-overlay.active .fullscreen-exit-btn {
            display: flex;
        }

        /* Fullscreen Timer - Optimized for Huawei Y7 Prime */
        .fullscreen-timer-container {
            position: relative;
            width: min(85vw, 85vh);
            height: min(85vw, 85vh);
            margin-bottom: 30px;
            max-width: 400px;
            max-height: 400px;
        }

        .fullscreen-timer-display {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 4px solid var(--focus);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 
                inset 0 0 60px rgba(0, 0, 0, 0.3),
                0 25px 60px rgba(0, 0, 0, 0.3);
            transition: border-color 0.5s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .fullscreen-timer-display.break { border-color: var(--break); }
        .fullscreen-timer-display.long-break { border-color: var(--long-break); }

        .fullscreen-time {
            font-size: min(5rem, 12vw);
            font-weight: 800;
            color: var(--text-light);
            margin-bottom: 12px;
            font-variant-numeric: tabular-nums;
            z-index: 2;
            position: relative;
            text-align: center;
            line-height: 1;
        }

        .fullscreen-timer-label {
            font-size: min(1.8rem, 4vw);
            font-weight: 600;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 2px;
            z-index: 2;
            position: relative;
            margin-bottom: 12px;
            text-align: center;
        }

        .fullscreen-session-info {
            color: var(--text-gray);
            font-size: 1rem;
            z-index: 2;
            position: relative;
            text-align: center;
        }

        /* Fullscreen Tree - Optimized for Mobile */
        .fullscreen-tree-container {
            position: absolute;
            width: min(60vw, 60vh);
            height: min(60vw, 60vh);
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: flex-end;
            justify-content: center;
            z-index: 1;
            pointer-events: none;
        }

        .fullscreen-tree {
            position: relative;
            width: min(40vw, 40vh);
            height: min(55vw, 55vh);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
        }

        .fullscreen-trunk {
            width: min(12px, 2.5vw);
            height: min(40px, 8vw);
            background: var(--trunk-color);
            border-radius: 3px;
            position: relative;
            z-index: 1;
            box-shadow: 
                inset 2px 0 0 rgba(255, 255, 255, 0.1),
                inset -2px 0 0 rgba(0, 0, 0, 0.3),
                0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .fullscreen-tree-layer {
            position: absolute;
            border-radius: 50% 50% 40% 40%;
            opacity: 0;
            transform: scale(0);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 2;
            box-shadow: 
                inset 0 0 15px rgba(0, 0, 0, 0.3),
                0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .fullscreen-tree-layer.active {
            opacity: 1;
            transform: scale(1);
        }

        .fullscreen-tree-layer-1 {
            width: min(55vw, 55vh);
            height: min(20vw, 20vh);
            bottom: min(40px, 8vw);
            background: radial-gradient(circle at 50% 100%, var(--tree-green-1), #1B5E20);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .fullscreen-tree-layer-2 {
            width: min(48vw, 48vh);
            height: min(18vw, 18vh);
            bottom: min(70px, 15vw);
            background: radial-gradient(circle at 50% 100%, var(--tree-green-2), #2E7D32);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.25));
        }

        .fullscreen-tree-layer-3 {
            width: min(41vw, 41vh);
            height: min(16vw, 16vh);
            bottom: min(95px, 20vw);
            background: radial-gradient(circle at 50% 100%, var(--tree-green-3), #388E3C);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
        }

        .fullscreen-tree-layer-4 {
            width: min(34vw, 34vh);
            height: min(14vw, 14vh);
            bottom: min(115px, 25vw);
            background: radial-gradient(circle at 50% 100%, var(--tree-green-4), #43A047);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15));
        }

        .fullscreen-tree-layer-5 {
            width: min(27vw, 27vh);
            height: min(12vw, 12vh);
            bottom: min(130px, 28vw);
            background: radial-gradient(circle at 50% 100%, var(--tree-green-5), #4CAF50);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }

        .fullscreen-tree-top {
            position: absolute;
            width: 0;
            height: 0;
            border-left: min(8px, 1.7vw) solid transparent;
            border-right: min(8px, 1.7vw) solid transparent;
            border-bottom: min(15px, 3.2vw) solid #2E7D32;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 3;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .fullscreen-tree-top.active {
            opacity: 1;
            transform: translateY(0);
            bottom: min(150px, 32vw);
        }

        .fullscreen-progress-ring {
            position: absolute;
            top: -4px;
            left: -4px;
            width: calc(100% + 8px);
            height: calc(100% + 8px);
            transform: rotate(-90deg);
        }

        .fullscreen-progress-ring circle {
            fill: transparent;
            stroke-width: 4;
            stroke-linecap: round;
        }

        .fullscreen-progress-ring-bg {
            stroke: rgba(255, 255, 255, 0.1);
        }

        .fullscreen-progress-ring-fill {
            stroke: var(--primary);
            stroke-dasharray: 1250;
            stroke-dashoffset: 1250;
            transition: stroke-dashoffset 1s linear;
        }

        .fullscreen-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            width: 100%;
            max-width: 400px;
        }

        .fullscreen-control-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            min-width: 100px;
            justify-content: center;
        }

        .fullscreen-control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .fullscreen-progress-indicator {
            text-align: center;
            color: var(--text-light);
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 15px;
            width: 100%;
            max-width: 400px;
        }

        body.light-theme .fullscreen-progress-indicator {
            color: var(--text-dark);
        }

        .fullscreen-pomodoro-counter {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
            width: 100%;
            max-width: 400px;
        }

        .fullscreen-pomodoro-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: var(--transition);
        }

        .fullscreen-pomodoro-dot.completed {
            background: var(--primary);
            transform: scale(1.3);
        }

        .fullscreen-pomodoro-dot.current {
            background: var(--secondary);
            animation: pulse-dot 2s infinite;
        }

        /* Fullscreen Notification */
        .fullscreen-notification {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            z-index: 10000;
            transform: translateY(-100%);
            transition: transform 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .fullscreen-notification.show {
            transform: translateY(0);
        }

        /* Footer - Mobile Optimized */
        footer {
            text-align: center;
            margin-top: 25px;
            padding: 15px 10px;
            color: var(--text-gray);
            font-size: 0.8rem;
            width: 100%;
        }

        .hotkeys {
            margin-top: 8px;
            font-size: 0.75rem;
        }

        .key {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            margin: 0 2px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.75rem;
        }

        body.light-theme .key {
            background: rgba(0, 0, 0, 0.1);
        }

        /* Mobile-specific optimizations */
        @media (min-width: 768px) {
            .container {
                padding: 20px;
            }
            
            header {
                margin-bottom: 30px;
                padding: 0 10px;
            }
            
            .main-grid {
                display: grid;
                grid-template-columns: 1fr 350px;
                gap: 25px;
            }
            
            .timer-display-container {
                width: 320px;
                height: 320px;
            }
            
            .time {
                font-size: 4rem;
            }
        }

        @media (orientation: landscape) and (max-height: 500px) {
            .container {
                padding: 5px;
            }
            
            .main-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .timer-section {
                padding: 15px;
            }
            
            .timer-display-container {
                width: 180px;
                height: 180px;
                margin: 0 auto 15px;
            }
            
            .time {
                font-size: 2.5rem;
            }
            
            .tree-container {
                width: 100px;
                height: 100px;
                bottom: 25px;
            }
        }

        /* Prevent text size adjustment on mobile */
        html {
            -webkit-text-size-adjust: 100%;
            text-size-adjust: 100%;
        }

        /* Better touch targets */
        button, 
        input[type="checkbox"],
        input[type="range"] {
            touch-action: manipulation;
        }

        /* Prevent zoom on input focus */
        input, select, textarea {
            font-size: 16px;
        }
    </style>
</head>
<body class="dark-theme">
    <!-- Fullscreen Exit Button -->
    <button class="fullscreen-exit-btn" id="fullscreen-exit-btn" title="Exit Fullscreen">
        <i class="fas fa-compress"></i>
    </button>

    <!-- Fullscreen Notification -->
    <div class="fullscreen-notification" id="fullscreen-notification">
        <i class="fas fa-expand"></i>
        <span>Press ESC or tap the exit button to exit fullscreen</span>
    </div>

    <!-- Fullscreen Overlay -->
    <div id="fullscreen-overlay" class="dark-theme">
        <div class="fullscreen-timer-container">
            <div class="fullscreen-timer-display" id="fullscreen-timer-display">
                <svg class="fullscreen-progress-ring" viewBox="0 0 508 508">
                    <circle class="fullscreen-progress-ring-bg" cx="254" cy="254" r="250"></circle>
                    <circle class="fullscreen-progress-ring-fill" cx="254" cy="254" r="250"></circle>
                </svg>

                <div class="fullscreen-tree-container">
                    <div class="fullscreen-tree" id="fullscreen-tree">
                        <div class="fullscreen-trunk" id="fullscreen-trunk"></div>
                    </div>
                </div>

                <div class="fullscreen-time" id="fullscreen-time-display">25:00</div>
                <div class="fullscreen-timer-label" id="fullscreen-timer-label">Focus Time</div>
                <div class="fullscreen-session-info" id="fullscreen-session-info">Session 1 of 4</div>
            </div>
        </div>

        <div class="fullscreen-controls">
            <button class="fullscreen-control-btn start-btn" id="fullscreen-start-btn">
                <i class="fas fa-play"></i> Start
            </button>
            <button class="fullscreen-control-btn pause-btn" id="fullscreen-pause-btn" disabled>
                <i class="fas fa-pause"></i> Pause
            </button>
            <button class="fullscreen-control-btn skip-btn" id="fullscreen-skip-btn">
                <i class="fas fa-forward"></i> Skip
            </button>
        </div>

        <div class="fullscreen-progress-indicator" id="fullscreen-progress-indicator">
            Progress: <span id="fullscreen-progress-text">0%</span>
        </div>

        <div class="fullscreen-pomodoro-counter" id="fullscreen-pomodoro-counter"></div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-hourglass-half"></i>
                <h1>Pomodoram</h1>
            </div>
            <div class="header-controls">
                <div class="theme-selector">
                    <button class="theme-btn dark active" data-theme="dark" title="Dark Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="theme-btn light" data-theme="light" title="Light Theme">
                        <i class="fas fa-sun"></i>
                    </button>
                    <button class="theme-btn nature" data-theme="nature" title="Nature Theme">
                        <i class="fas fa-leaf"></i>
                    </button>
                </div>
                <button class="fullscreen-btn" id="fullscreen-btn" title="Toggle Fullscreen">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
        </header>

        <div class="main-grid">
            <main class="timer-section">
                <div class="mode-selector">
                    <button class="mode-btn focus active" data-mode="focus">Focus</button>
                    <button class="mode-btn break" data-mode="break">Break</button>
                    <button class="mode-btn long-break" data-mode="longBreak">Long Break</button>
                </div>

                <div class="timer-display-container">
                    <div class="timer-display" id="timer-display">
                        <svg class="progress-ring" viewBox="0 0 366 366">
                            <circle class="progress-ring-bg" cx="183" cy="183" r="180"></circle>
                            <circle class="progress-ring-fill" cx="183" cy="183" r="180"></circle>
                        </svg>

                        <div class="tree-container">
                            <div class="tree" id="tree">
                                <div class="trunk" id="trunk"></div>
                            </div>
                        </div>

                        <div class="time" id="time-display">25:00</div>
                        <div class="timer-label" id="timer-label">Focus Time</div>
                        <div class="session-info" id="session-info">Session 1 of 4</div>
                    </div>
                </div>

                <div class="pomodoro-counter" id="pomodoro-counter"></div>

                <div class="timer-controls">
                    <button class="control-btn start-btn" id="start-btn">
                        <i class="fas fa-play"></i> Start
                    </button>
                    <button class="control-btn pause-btn" id="pause-btn" disabled>
                        <i class="fas fa-pause"></i> Pause
                    </button>
                    <button class="control-btn skip-btn" id="skip-btn">
                        <i class="fas fa-forward"></i> Skip
                    </button>
                </div>

                <div class="progress-indicator" id="progress-indicator">
                    <div class="time-progress" id="time-progress">Progress: 0%</div>
                </div>

                <div class="stats-tasks-grid">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="completed-pomodoros">0</div>
                            <div class="stat-label">Pomodoros</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="focus-time-today">0m</div>
                            <div class="stat-label">Focus Time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="break-time-today">0m</div>
                            <div class="stat-label">Break Time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="tasks-completed">0</div>
                            <div class="stat-label">Tasks Done</div>
                        </div>
                    </div>

                    <div class="tasks-preview">
                        <h3 class="tasks-preview-title">
                            <i class="fas fa-tasks"></i> Today's Tasks
                        </h3>
                        <ul class="tasks-preview-list" id="tasks-preview-list">
                            <li class="task-preview-item">
                                <div style="text-align: center; padding: 15px; color: var(--text-gray); font-size: 0.9rem;">
                                    No tasks yet. Add one in the task list!
                                </div>
                            </li>
                        </ul>
                        <div class="view-all-tasks">
                            <button class="view-all-btn" id="view-all-tasks-btn">
                                <i class="fas fa-external-link-alt"></i> View All Tasks
                            </button>
                        </div>
                    </div>
                </div>
            </main>

            <div class="sidebar">
                <!-- Tasks Panel -->
                <div class="panel tasks-panel">
                    <h2 class="panel-title"><i class="fas fa-tasks"></i> Task List</h2>
                    
                    <div class="task-input-container">
                        <input type="text" class="task-input" id="task-input" placeholder="Add a new task...">
                        <button class="add-task-btn" id="add-task-btn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>

                    <ul class="tasks-list" id="tasks-list"></ul>
                </div>

                <!-- Music Panel -->
                <div class="panel music-panel">
                    <h2 class="panel-title"><i class="fas fa-music"></i> Study Music</h2>
                    <div class="spotify-player">
                        <iframe
                            style="border-radius:10px"
                            src="https://open.spotify.com/embed/playlist/351LrlEyDvMCXzWJbDIs2p?utm_source=generator&theme=0"
                            width="290"
                            height="500"
                            frameBorder="0"
                            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                            loading="lazy">
                        </iframe>
                    </div>
                </div>

                <!-- Settings Panel -->
                <div class="panel settings-panel">
                    <h2 class="panel-title"><i class="fas fa-cog"></i> Timer Settings</h2>
                    
                    <div class="setting">
                        <label>Focus Time: <span id="focus-value" class="value-display">25</span> min</label>
                        <div class="slider-container">
                            <input type="range" id="focus-time" min="5" max="60" value="25" step="5">
                        </div>
                    </div>

                    <div class="setting">
                        <label>Break Time: <span id="break-value" class="value-display">5</span> min</label>
                        <div class="slider-container">
                            <input type="range" id="break-time" min="1" max="30" value="5" step="1">
                        </div>
                    </div>

                    <div class="setting">
                        <label>Long Break: <span id="long-break-value" class="value-display">15</span> min</label>
                        <div class="slider-container">
                            <input type="range" id="long-break-time" min="5" max="45" value="15" step="5">
                        </div>
                    </div>

                    <div class="setting">
                        <label>Sessions Until Long Break: <span id="sessions-value" class="value-display">4</span></label>
                        <div class="slider-container">
                            <input type="range" id="sessions-count" min="2" max="8" value="4" step="1">
                        </div>
                    </div>

                    <div class="alarm-selector">
                        <label>Alarm Sound</label>
                        <div class="alarm-buttons" id="alarm-buttons">
                            <!-- Alarm buttons will be generated by JavaScript -->
                        </div>
                    </div>

                    <div class="auto-apply">
                        <input type="checkbox" id="auto-apply" checked>
                        <label for="auto-apply">Apply changes immediately</label>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Pomodoram &copy; 2026 | pomodoram.online | Focus Timer based on the Pomodoro Technique</p>
            <div class="hotkeys">
                <span class="key">Space</span> Start/Pause 
                <span class="key">S</span> Skip 
                <span class="key">F</span> Fullscreen 
                <span class="key">ESC</span> Exit Fullscreen
            </div>
        </footer>
    </div>

    <script>
        // ==================== GLOBAL VARIABLES ====================
        let timer = null;
        let isRunning = false;
        let timeLeft = 0;
        let currentMode = 'focus';
        let pomodoroCount = 0;
        let totalPomodoros = 0;
        let focusTimeToday = 0;
        let breakTimeToday = 0;
        let tasksCompleted = 0;
        let treeStage = 0;
        let isFullscreen = false;
        
        // Timer settings
        let focusTime = 25 * 60;
        let breakTime = 5 * 60;
        let longBreakTime = 15 * 60;
        let sessionsUntilLongBreak = 4;
        
        // Alarm Sounds
        let alarmSounds = [];
        let selectedAlarmSound = "beep";
        
        // Task Reminder
        let taskReminderInterval;
        let lastReminderTime = 0;
        
        // DOM Elements - Main View
        const timeDisplay = document.getElementById('time-display');
        const timerLabel = document.getElementById('timer-label');
        const sessionInfo = document.getElementById('session-info');
        const timerDisplay = document.getElementById('timer-display');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const skipBtn = document.getElementById('skip-btn');
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        const fullscreenNotification = document.getElementById('fullscreen-notification');
        const modeButtons = document.querySelectorAll('.mode-btn');
        const themeButtons = document.querySelectorAll('.theme-btn');
        const pomodoroCounter = document.getElementById('pomodoro-counter');
        const progressRingFill = document.querySelector('.progress-ring-fill');
        const timeProgress = document.getElementById('time-progress');
        
        // Tasks Preview Elements
        const tasksPreviewList = document.getElementById('tasks-preview-list');
        const viewAllTasksBtn = document.getElementById('view-all-tasks-btn');
        
        // DOM Elements - Fullscreen View
        const fullscreenOverlay = document.getElementById('fullscreen-overlay');
        const fullscreenTimeDisplay = document.getElementById('fullscreen-time-display');
        const fullscreenTimerLabel = document.getElementById('fullscreen-timer-label');
        const fullscreenSessionInfo = document.getElementById('fullscreen-session-info');
        const fullscreenTimerDisplay = document.getElementById('fullscreen-timer-display');
        const fullscreenStartBtn = document.getElementById('fullscreen-start-btn');
        const fullscreenPauseBtn = document.getElementById('fullscreen-pause-btn');
        const fullscreenSkipBtn = document.getElementById('fullscreen-skip-btn');
        const fullscreenProgressIndicator = document.getElementById('fullscreen-progress-indicator');
        const fullscreenProgressText = document.getElementById('fullscreen-progress-text');
        const fullscreenPomodoroCounter = document.getElementById('fullscreen-pomodoro-counter');
        const fullscreenProgressRingFill = document.querySelector('.fullscreen-progress-ring-fill');
        const fullscreenExitBtn = document.getElementById('fullscreen-exit-btn');
        
        // Tree elements
        const tree = document.getElementById('tree');
        const fullscreenTree = document.getElementById('fullscreen-tree');
        
        // Settings elements
        const focusTimeInput = document.getElementById('focus-time');
        const breakTimeInput = document.getElementById('break-time');
        const longBreakTimeInput = document.getElementById('long-break-time');
        const sessionsCountInput = document.getElementById('sessions-count');
        const focusValue = document.getElementById('focus-value');
        const breakValue = document.getElementById('break-value');
        const longBreakValue = document.getElementById('long-break-value');
        const sessionsValue = document.getElementById('sessions-value');
        const autoApplyCheckbox = document.getElementById('auto-apply');
        
        // Stats elements
        const completedPomodorosEl = document.getElementById('completed-pomodoros');
        const focusTimeTodayEl = document.getElementById('focus-time-today');
        const breakTimeTodayEl = document.getElementById('break-time-today');
        const tasksCompletedEl = document.getElementById('tasks-completed');
        
        // Task elements
        const taskInput = document.getElementById('task-input');
        const addTaskBtn = document.getElementById('add-task-btn');
        const tasksList = document.getElementById('tasks-list');
        
        // Alarm buttons container
        const alarmButtonsContainer = document.getElementById('alarm-buttons');
        
        // ==================== INITIALIZATION ====================
        function init() {
            console.log("Initializing Pomodoram...");
            loadFromLocalStorage();
            timeLeft = getCurrentModeDuration();
            updateDisplay();
            updateFullscreenDisplay();
            updateTree();
            updateFullscreenTree();
            updatePomodoroCounter();
            updateFullscreenPomodoroCounter();
            updateSessionInfo();
            updateStats();
            renderTasks();
            updateTasksPreview();
            setupEventListeners();
            updateSettingsDisplay();
            
            // Initialize Alarm Sounds
            initAlarmSounds();
            
            // Start 2-hour Task Reminder Check
            startTaskReminder();
            
            // Adjust layout for Huawei Y7 Prime
            adjustForMobile();
            
            console.log("Pomodoram initialized successfully!");
        }
        
        // ==================== MOBILE OPTIMIZATION ====================
        function adjustForMobile() {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // Adjust timer size based on screen size
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                
                if (screenWidth <= 360) {
                    // Very small screens
                    document.querySelector('.timer-display-container').style.width = '220px';
                    document.querySelector('.timer-display-container').style.height = '220px';
                }
                
                // Adjust fullscreen timer for landscape mode
                if (screenHeight < 500) {
                    document.querySelector('.fullscreen-timer-container').style.maxWidth = '70vh';
                    document.querySelector('.fullscreen-timer-container').style.maxHeight = '70vh';
                }
            }
        }
        
        // ==================== TIMER FUNCTIONS ====================
        function toggleTimer() {
            if (isRunning) {
                pauseTimer();
            } else {
                startTimer();
            }
        }
        
        function startTimer() {
            if (timeLeft === 0) {
                timeLeft = getCurrentModeDuration();
            }
            
            isRunning = true;
            
            // Update main view buttons
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            startBtn.innerHTML = '<i class="fas fa-play"></i> Running';
            
            // Update fullscreen view buttons
            fullscreenStartBtn.disabled = true;
            fullscreenPauseBtn.disabled = false;
            fullscreenStartBtn.innerHTML = '<i class="fas fa-play"></i> Running';
            
            timer = setInterval(() => {
                timeLeft--;
                updateDisplay();
                updateFullscreenDisplay();
                
                // Update tree growth during focus session
                if (currentMode === 'focus') {
                    updateTreeGrowth();
                    focusTimeToday++;
                } else {
                    breakTimeToday++;
                }
                
                updateStats();
                
                if (timeLeft <= 0) {
                    completeSession();
                }
            }, 1000);
        }
        
        function pauseTimer() {
            clearInterval(timer);
            isRunning = false;
            
            // Update main view buttons
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            startBtn.innerHTML = '<i class="fas fa-play"></i> Resume';
            
            // Update fullscreen view buttons
            fullscreenStartBtn.disabled = false;
            fullscreenPauseBtn.disabled = true;
            fullscreenStartBtn.innerHTML = '<i class="fas fa-play"></i> Resume';
        }
        
        function skipSession() {
            if (isRunning) pauseTimer();
            completeSession();
        }
        
        function completeSession() {
            clearInterval(timer);
            isRunning = false;
            
            // Update main view buttons
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            startBtn.innerHTML = '<i class="fas fa-play"></i> Start';
            
            // Update fullscreen view buttons
            fullscreenStartBtn.disabled = false;
            fullscreenPauseBtn.disabled = true;
            fullscreenStartBtn.innerHTML = '<i class="fas fa-play"></i> Start';
            
            // Play alarm sound
            playAlarmSound();
            
            // Show notification
            showNotification("Session complete! Time for a break.", "info");
            
            if (currentMode === 'focus') {
                totalPomodoros++;
                pomodoroCount++;
                
                // Reset tree for next session
                treeStage = 0;
                updateTree();
                updateFullscreenTree();
                
                if (pomodoroCount >= sessionsUntilLongBreak) {
                    pomodoroCount = 0;
                    currentMode = 'longBreak';
                } else {
                    currentMode = 'break';
                }
            } else {
                currentMode = 'focus';
            }
            
            // Update active mode button
            modeButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.mode === currentMode) {
                    btn.classList.add('active');
                }
            });
            
            resetTimer();
            saveToLocalStorage();
        }
        
        function resetTimer() {
            timeLeft = getCurrentModeDuration();
            updateDisplay();
            updateFullscreenDisplay();
            updatePomodoroCounter();
            updateFullscreenPomodoroCounter();
            updateSessionInfo();
        }
        
        function getCurrentModeDuration() {
            switch(currentMode) {
                case 'focus': return focusTime;
                case 'break': return breakTime;
                case 'longBreak': return longBreakTime;
                default: return focusTime;
            }
        }
        
        // ==================== DISPLAY FUNCTIONS ====================
        function updateDisplay() {
            // Update time display
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update timer label
            const labels = {
                'focus': 'Focus Time',
                'break': 'Break Time',
                'longBreak': 'Long Break'
            };
            timerLabel.textContent = labels[currentMode];
            
            // Update timer border color
            timerDisplay.className = 'timer-display';
            timerDisplay.classList.add(currentMode);
            
            // Update progress ring
            const totalDuration = getCurrentModeDuration();
            const progress = ((totalDuration - timeLeft) / totalDuration) * 880;
            if (progressRingFill) {
                progressRingFill.style.strokeDashoffset = 880 - progress;
                
                // Update progress ring color
                const progressColor = getModeColor(currentMode);
                progressRingFill.style.stroke = progressColor;
                
                // Update progress text
                const progressPercent = Math.round(((totalDuration - timeLeft) / totalDuration) * 100);
                timeProgress.textContent = `Progress: ${progressPercent}%`;
                timeProgress.style.color = progressColor;
            }
        }
        
        function updateFullscreenDisplay() {
            // Update time display
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            fullscreenTimeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update timer label
            const labels = {
                'focus': 'Focus Time',
                'break': 'Break Time',
                'longBreak': 'Long Break'
            };
            fullscreenTimerLabel.textContent = labels[currentMode];
            
            // Update timer border color
            fullscreenTimerDisplay.className = 'fullscreen-timer-display';
            fullscreenTimerDisplay.classList.add(currentMode);
            
            // Update progress ring
            const totalDuration = getCurrentModeDuration();
            const progress = ((totalDuration - timeLeft) / totalDuration) * 1250;
            if (fullscreenProgressRingFill) {
                fullscreenProgressRingFill.style.strokeDashoffset = 1250 - progress;
                
                // Update progress ring color
                const progressColor = getModeColor(currentMode);
                fullscreenProgressRingFill.style.stroke = progressColor;
                
                // Update progress text
                const progressPercent = Math.round(((totalDuration - timeLeft) / totalDuration) * 100);
                fullscreenProgressText.textContent = `${progressPercent}%`;
                fullscreenProgressIndicator.style.color = progressColor;
                
                // Update session info
                fullscreenSessionInfo.textContent = `Session ${pomodoroCount + 1} of ${sessionsUntilLongBreak}`;
            }
        }
        
        function getModeColor(mode) {
            switch(mode) {
                case 'focus': return '#10B981';
                case 'break': return '#3B82F6';
                case 'longBreak': return '#8B5CF6';
                default: return '#10B981';
            }
        }
        
        // ==================== TREE FUNCTIONS ====================
        function updateTree() {
            // Clear existing tree layers and top
            const existingLayers = tree.querySelectorAll('.tree-layer');
            existingLayers.forEach(layer => layer.remove());
            
            const existingTop = tree.querySelector('.tree-top');
            if (existingTop) existingTop.remove();
            
            // Add tree layers based on tree stage
            for (let i = 1; i <= treeStage; i++) {
                const layer = document.createElement('div');
                layer.className = `tree-layer tree-layer-${i}`;
                tree.appendChild(layer);
                
                // Animate layer appearance
                setTimeout(() => {
                    layer.classList.add('active');
                }, i * 200);
            }
            
            // Add tree top if tree has at least 3 layers
            if (treeStage >= 3) {
                const treeTop = document.createElement('div');
                treeTop.className = 'tree-top';
                tree.appendChild(treeTop);
                
                setTimeout(() => {
                    treeTop.classList.add('active');
                }, 300);
            }
        }
        
        function updateFullscreenTree() {
            // Clear existing tree layers and top
            const existingLayers = fullscreenTree.querySelectorAll('.fullscreen-tree-layer');
            existingLayers.forEach(layer => layer.remove());
            
            const existingTop = fullscreenTree.querySelector('.fullscreen-tree-top');
            if (existingTop) existingTop.remove();
            
            // Add tree layers based on tree stage
            for (let i = 1; i <= treeStage; i++) {
                const layer = document.createElement('div');
                layer.className = `fullscreen-tree-layer fullscreen-tree-layer-${i}`;
                fullscreenTree.appendChild(layer);
                
                // Animate layer appearance
                setTimeout(() => {
                    layer.classList.add('active');
                }, i * 200);
            }
            
            // Add tree top if tree has at least 3 layers
            if (treeStage >= 3) {
                const treeTop = document.createElement('div');
                treeTop.className = 'fullscreen-tree-top';
                fullscreenTree.appendChild(treeTop);
                
                setTimeout(() => {
                    treeTop.classList.add('active');
                }, 300);
            }
        }
        
        function updateTreeGrowth() {
            if (currentMode === 'focus') {
                const totalDuration = getCurrentModeDuration();
                const timeElapsed = totalDuration - timeLeft;
                const progress = timeElapsed / totalDuration;
                
                // Tree grows from 0 to 5 stages during focus session
                const newTreeStage = Math.min(5, Math.floor(progress * 6)); // 0-5
                
                if (newTreeStage !== treeStage) {
                    treeStage = newTreeStage;
                    updateTree();
                    updateFullscreenTree();
                }
            }
        }
        
        // ==================== ALARM SOUNDS SYSTEM ====================
        function initAlarmSounds() {
            // Initialize alarm sounds
            alarmSounds = [
                { 
                    name: "Classic Beep", 
                    type: "beep",
                    play: function() { playBeep(800, 0.5, 0.5); }
                },
                { 
                    name: "Gentle Chime", 
                    type: "chime",
                    play: function() { playChime(); }
                },
                { 
                    name: "Digital Bell", 
                    type: "bell",
                    play: function() { playBell(); }
                },
                { 
                    name: "Soft Notification", 
                    type: "soft",
                    play: function() { playSoftNotification(); }
                }
            ];
            
            // Create alarm buttons
            alarmButtonsContainer.innerHTML = '';
            alarmSounds.forEach((sound, index) => {
                const button = document.createElement('button');
                button.className = `alarm-btn ${sound.type === selectedAlarmSound ? 'active' : ''}`;
                button.innerHTML = `<i class="fas fa-volume-up"></i> ${sound.name}`;
                button.dataset.sound = sound.type;
                button.addEventListener('click', () => selectAlarmSound(sound.type));
                alarmButtonsContainer.appendChild(button);
            });
        }
        
        function selectAlarmSound(soundType) {
            selectedAlarmSound = soundType;
            
            // Update UI
            document.querySelectorAll('.alarm-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.sound === soundType);
            });
            
            // Test the sound
            testAlarmSound();
            
            saveToLocalStorage();
        }
        
        function testAlarmSound() {
            const sound = alarmSounds.find(s => s.type === selectedAlarmSound);
            if (sound && sound.play) {
                sound.play();
            }
        }
        
        function playAlarmSound() {
            const sound = alarmSounds.find(s => s.type === selectedAlarmSound);
            if (sound && sound.play) {
                sound.play();
            }
        }
        
        // Sound generation functions
        function playBeep(frequency, duration, volume) {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            } catch (e) {
                // Fallback: Use simple beep with HTML audio
                const audio = new Audio();
                audio.src = "data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==";
                audio.volume = volume;
                audio.play().catch(() => {
                    // If all else fails, just log
                    console.log("Beep!");
                });
            }
        }
        
        function playChime() {
            playBeep(523.25, 0.3, 0.3); // C5
            setTimeout(() => playBeep(659.25, 0.3, 0.3), 100); // E5
            setTimeout(() => playBeep(783.99, 0.5, 0.3), 200); // G5
        }
        
        function playBell() {
            playBeep(784, 0.1, 0.5);
            setTimeout(() => playBeep(784, 0.1, 0.4), 150);
            setTimeout(() => playBeep(784, 0.1, 0.3), 300);
        }
        
        function playSoftNotification() {
            playBeep(440, 0.2, 0.2);
            setTimeout(() => playBeep(440, 0.2, 0.1), 100);
        }
        
        // ==================== TASKS PREVIEW FUNCTIONS ====================
        function updateTasksPreview() {
            const tasks = getTasks();
            const today = new Date().toDateString();
            const todayTasks = tasks.filter(task => {
                const taskDate = new Date(task.createdAt).toDateString();
                return taskDate === today;
            }).slice(0, 5); // Show only first 5 tasks
            
            tasksPreviewList.innerHTML = '';
            
            if (todayTasks.length === 0) {
                tasksPreviewList.innerHTML = `
                    <li class="task-preview-item">
                        <div style="text-align: center; padding: 15px; color: var(--text-gray); font-size: 0.9rem;">
                            No tasks yet. Add one in the task list!
                        </div>
                    </li>
                `;
                return;
            }
            
            todayTasks.forEach(task => {
                const li = document.createElement('li');
                li.className = 'task-preview-item';
                
                li.innerHTML = `
                    <input type="checkbox" class="task-preview-checkbox" ${task.completed ? 'checked' : ''} data-id="${task.id}">
                    <span class="task-preview-text ${task.completed ? 'completed' : ''}">${task.text}</span>
                `;
                
                tasksPreviewList.appendChild(li);
            });
            
            // Add event listeners to preview checkboxes
            document.querySelectorAll('.task-preview-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const taskId = parseInt(this.dataset.id);
                    const completed = this.checked;
                    
                    const tasks = getTasks();
                    const taskIndex = tasks.findIndex(task => task.id === taskId);
                    
                    if (taskIndex !== -1) {
                        tasks[taskIndex].completed = completed;
                        localStorage.setItem('pomodoram_tasks', JSON.stringify(tasks));
                        
                        if (completed) {
                            tasksCompleted++;
                        } else {
                            tasksCompleted--;
                        }
                        
                        updateStats();
                        updateTasksPreview();
                        renderTasks();
                        saveToLocalStorage();
                    }
                });
            });
        }
        
        // ==================== EVENT LISTENERS ====================
        function setupEventListeners() {
            console.log("Setting up event listeners...");
            
            // Main timer controls
            startBtn.addEventListener('click', toggleTimer);
            pauseBtn.addEventListener('click', pauseTimer);
            skipBtn.addEventListener('click', skipSession);
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            
            // Fullscreen timer controls
            fullscreenStartBtn.addEventListener('click', toggleTimer);
            fullscreenPauseBtn.addEventListener('click', pauseTimer);
            fullscreenSkipBtn.addEventListener('click', skipSession);
            fullscreenExitBtn.addEventListener('click', exitFullscreen);
            
            // Mode selection
            modeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (!isRunning) {
                        modeButtons.forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        currentMode = this.dataset.mode;
                        resetTimer();
                    }
                });
            });
            
            // Theme selection
            themeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const theme = this.dataset.theme;
                    setTheme(theme);
                    themeButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Settings changes
            focusTimeInput.addEventListener('input', updateSettings);
            breakTimeInput.addEventListener('input', updateSettings);
            longBreakTimeInput.addEventListener('input', updateSettings);
            sessionsCountInput.addEventListener('input', updateSettings);
            
            // Task management
            addTaskBtn.addEventListener('click', addTask);
            taskInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addTask();
            });
            
            // View all tasks button
            viewAllTasksBtn.addEventListener('click', () => {
                // Scroll to tasks panel
                document.querySelector('.tasks-panel').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcut);
            
            // Window resize for mobile optimization
            window.addEventListener('resize', handleResize);
            
            // Prevent zoom on double-tap
            document.addEventListener('touchstart', function(event) {
                if (event.touches.length > 1) {
                    event.preventDefault();
                }
            }, { passive: false });
            
            console.log("Event listeners set up successfully");
        }
        
        function handleResize() {
            adjustForMobile();
        }
        
        // ==================== FULLSCREEN FUNCTIONS ====================
        function toggleFullscreen() {
            if (isFullscreen) {
                exitFullscreen();
            } else {
                enterFullscreen();
            }
        }
        
        function enterFullscreen() {
            isFullscreen = true;
            
            // Show fullscreen overlay
            fullscreenOverlay.classList.add('active');
            fullscreenOverlay.className = 'active ' + document.body.className;
            
            // Show exit button
            fullscreenExitBtn.style.display = 'flex';
            
            // Update fullscreen display
            updateFullscreenDisplay();
            
            // Show notification for 5 seconds
            showFullscreenNotification();
            
            // Lock orientation on mobile
            if (screen.orientation && screen.orientation.lock) {
                screen.orientation.lock('portrait').catch(() => {
                    // Orientation lock not supported
                });
            }
            
            saveToLocalStorage();
        }
        
        function exitFullscreen() {
            isFullscreen = false;
            fullscreenOverlay.classList.remove('active');
            fullscreenExitBtn.style.display = 'none';
            
            // Unlock orientation
            if (screen.orientation && screen.orientation.unlock) {
                screen.orientation.unlock();
            }
            
            saveToLocalStorage();
        }
        
        function showFullscreenNotification() {
            fullscreenNotification.classList.add('show');
            setTimeout(() => {
                fullscreenNotification.classList.remove('show');
            }, 5000);
        }
        
        // ==================== THEME FUNCTIONS ====================
        function setTheme(theme) {
            document.body.className = `${theme}-theme`;
            if (isFullscreen) {
                fullscreenOverlay.className = `active ${theme}-theme`;
            }
            saveToLocalStorage();
        }
        
        // ==================== SETTINGS FUNCTIONS ====================
        function updateSettings() {
            // Update displayed values
            focusValue.textContent = focusTimeInput.value;
            breakValue.textContent = breakTimeInput.value;
            longBreakValue.textContent = longBreakTimeInput.value;
            sessionsValue.textContent = sessionsCountInput.value;
            
            // Update timer settings
            focusTime = parseInt(focusTimeInput.value) * 60;
            breakTime = parseInt(breakTimeInput.value) * 60;
            longBreakTime = parseInt(longBreakTimeInput.value) * 60;
            sessionsUntilLongBreak = parseInt(sessionsCountInput.value);
            
            // Apply changes if auto-apply is enabled or timer is not running
            if (autoApplyCheckbox.checked || !isRunning) {
                resetTimer();
            }
            
            updatePomodoroCounter();
            updateFullscreenPomodoroCounter();
            saveToLocalStorage();
        }
        
        function updateSettingsDisplay() {
            focusTimeInput.value = focusTime / 60;
            breakTimeInput.value = breakTime / 60;
            longBreakTimeInput.value = longBreakTime / 60;
            sessionsCountInput.value = sessionsUntilLongBreak;
            
            focusValue.textContent = focusTime / 60;
            breakValue.textContent = breakTime / 60;
            longBreakValue.textContent = longBreakTime / 60;
            sessionsValue.textContent = sessionsUntilLongBreak;
        }
        
        // ==================== TASK REMINDER SYSTEM ====================
        function startTaskReminder() {
            // Check every minute if 2 hours have passed
            taskReminderInterval = setInterval(() => {
                const now = Date.now();
                const twoHours = 2 * 60 * 60 * 1000;
                
                if (now - lastReminderTime >= twoHours) {
                    checkPendingTasks();
                    lastReminderTime = now;
                }
            }, 60000); // Check every minute
        }
        
        function checkPendingTasks() {
            const tasks = getTasks();
            const pendingTasks = tasks.filter(task => !task.completed);
            
            if (pendingTasks.length > 0) {
                showNotification(` You have ${pendingTasks.length} task(s) pending. Keep going!`, "info");
            }
        }
        
        // ==================== NOTIFICATION FUNCTIONS ====================
        function showNotification(message, type = "info") {
            // Remove any existing notifications
            const existingNotifications = document.querySelectorAll('.fullscreen-notification.show');
            existingNotifications.forEach(notification => notification.remove());
            
            const notification = document.createElement('div');
            notification.className = `fullscreen-notification show ${type}`;
            notification.innerHTML = `<i class="fas fa-${type === 'error' ? 'exclamation-triangle' : 'bell'}"></i><span>${message}</span>`;
            document.body.appendChild(notification);
            
            // Remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }
        
        // ==================== POMODORO COUNTER ====================
        function updatePomodoroCounter() {
            pomodoroCounter.innerHTML = '';
            
            for (let i = 0; i < sessionsUntilLongBreak; i++) {
                const dot = document.createElement('div');
                dot.className = 'pomodoro-dot';
                
                if (i < pomodoroCount) {
                    dot.classList.add('completed');
                } else if (i === pomodoroCount && currentMode === 'focus') {
                    dot.classList.add('current');
                }
                
                pomodoroCounter.appendChild(dot);
            }
        }
        
        function updateFullscreenPomodoroCounter() {
            fullscreenPomodoroCounter.innerHTML = '';
            
            for (let i = 0; i < sessionsUntilLongBreak; i++) {
                const dot = document.createElement('div');
                dot.className = 'fullscreen-pomodoro-dot';
                
                if (i < pomodoroCount) {
                    dot.classList.add('completed');
                } else if (i === pomodoroCount && currentMode === 'focus') {
                    dot.classList.add('current');
                }
                
                fullscreenPomodoroCounter.appendChild(dot);
            }
        }
        
        function updateSessionInfo() {
            sessionInfo.textContent = `Session ${pomodoroCount + 1} of ${sessionsUntilLongBreak}`;
        }
        
        // ==================== STATS FUNCTIONS ====================
        function updateStats() {
            completedPomodorosEl.textContent = totalPomodoros;
            focusTimeTodayEl.textContent = `${Math.floor(focusTimeToday / 60)}m`;
            breakTimeTodayEl.textContent = `${Math.floor(breakTimeToday / 60)}m`;
            tasksCompletedEl.textContent = tasksCompleted;
        }
        
        // ==================== TASK FUNCTIONS ====================
        function addTask() {
            const text = taskInput.value.trim();
            if (!text) return;
            
            const task = {
                id: Date.now(),
                text: text,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            saveTask(task);
            renderTasks();
            updateTasksPreview();
            taskInput.value = '';
            taskInput.focus();
        }
        
        function saveTask(task) {
            const tasks = getTasks();
            tasks.push(task);
            localStorage.setItem('pomodoram_tasks', JSON.stringify(tasks));
        }
        
        function getTasks() {
            const tasksJson = localStorage.getItem('pomodoram_tasks');
            return tasksJson ? JSON.parse(tasksJson) : [];
        }
        
        function renderTasks() {
            const tasks = getTasks();
            tasksList.innerHTML = '';
            
            if (tasks.length === 0) {
                tasksList.innerHTML = '<div style="text-align: center; padding: 15px; color: var(--text-gray); font-size: 0.9rem;">No tasks yet. Add one above!</div>';
                return;
            }
            
            // Sort tasks: incomplete first, then by creation date
            const sortedTasks = [...tasks].sort((a, b) => {
                if (a.completed !== b.completed) {
                    return a.completed ? 1 : -1;
                }
                return new Date(b.createdAt) - new Date(a.createdAt);
            });
            
            sortedTasks.forEach(task => {
                const li = document.createElement('li');
                li.className = `task-item ${task.completed ? 'completed' : ''}`;
                li.dataset.id = task.id;
                
                li.innerHTML = `
                    <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''}>
                    <span class="task-text ${task.completed ? 'completed' : ''}" contenteditable="true">${task.text}</span>
                    <div class="task-actions">
                        <button class="task-action-btn edit-btn" title="Edit task">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="task-action-btn delete-btn" title="Delete task">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                tasksList.appendChild(li);
            });
            
            // Add event listeners to tasks
            setupTaskEventListeners();
        }
        
        function setupTaskEventListeners() {
            // Checkbox event listeners
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', handleTaskComplete);
            });
            
            // Edit button event listeners
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', handleTaskEdit);
            });
            
            // Delete button event listeners
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', handleTaskDelete);
            });
            
            // Make task text editable
            document.querySelectorAll('.task-text').forEach(taskText => {
                taskText.addEventListener('blur', function() {
                    handleTaskTextEdit(this);
                });
                
                taskText.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        this.blur();
                    }
                });
            });
        }
        
        function handleTaskComplete(e) {
            const taskId = parseInt(e.target.closest('.task-item').dataset.id);
            const completed = e.target.checked;
            
            const tasks = getTasks();
            const taskIndex = tasks.findIndex(task => task.id === taskId);
            
            if (taskIndex !== -1) {
                tasks[taskIndex].completed = completed;
                localStorage.setItem('pomodoram_tasks', JSON.stringify(tasks));
                
                if (completed) {
                    tasksCompleted++;
                } else {
                    tasksCompleted--;
                }
                
                updateStats();
                updateTasksPreview();
                e.target.closest('.task-item').classList.toggle('completed');
                e.target.nextElementSibling.classList.toggle('completed');
                saveToLocalStorage();
            }
        }
        
        function handleTaskEdit(e) {
            const taskId = parseInt(e.target.closest('.task-item').dataset.id);
            const tasks = getTasks();
            const taskIndex = tasks.findIndex(task => task.id === taskId);
            
            if (taskIndex === -1) return;
            
            const taskTextElement = e.target.closest('.task-item').querySelector('.task-text');
            taskTextElement.focus();
            
            // Select all text for easy editing
            const range = document.createRange();
            range.selectNodeContents(taskTextElement);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
        }
        
        function handleTaskTextEdit(taskTextElement) {
            const taskId = parseInt(taskTextElement.closest('.task-item').dataset.id);
            const newText = taskTextElement.textContent.trim();
            
            if (!newText) {
                // If text is empty, delete the task
                handleTaskDelete({ target: { closest: () => taskTextElement.closest('.task-item') } });
                return;
            }
            
            const tasks = getTasks();
            const taskIndex = tasks.findIndex(task => task.id === taskId);
            
            if (taskIndex !== -1) {
                tasks[taskIndex].text = newText;
                localStorage.setItem('pomodoram_tasks', JSON.stringify(tasks));
                updateTasksPreview();
                saveToLocalStorage();
            }
        }
        
        function handleTaskDelete(e) {
            const taskItem = e.target.closest('.task-item');
            const taskId = parseInt(taskItem.dataset.id);
            
            const tasks = getTasks();
            const taskIndex = tasks.findIndex(task => task.id === taskId);
            
            if (taskIndex === -1) return;
            
            // Update tasks completed count if the task was completed
            if (tasks[taskIndex].completed) {
                tasksCompleted--;
                updateStats();
            }
            
            tasks.splice(taskIndex, 1);
            localStorage.setItem('pomodoram_tasks', JSON.stringify(tasks));
            renderTasks();
            updateTasksPreview();
            saveToLocalStorage();
        }
        
        // ==================== KEYBOARD SHORTCUTS ====================
        function handleKeyboardShortcut(e) {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
            
            switch(e.key.toLowerCase()) {
                case ' ':
                    e.preventDefault();
                    toggleTimer();
                    break;
                case 's':
                    e.preventDefault();
                    skipSession();
                    break;
                case 'f':
                    e.preventDefault();
                    toggleFullscreen();
                    break;
                case 'escape':
                    if (isFullscreen) {
                        exitFullscreen();
                    }
                    break;
            }
        }
        
        // ==================== LOCAL STORAGE ====================
        function saveToLocalStorage() {
            const data = {
                totalPomodoros,
                focusTimeToday,
                breakTimeToday,
                tasksCompleted,
                pomodoroCount,
                treeStage,
                currentMode,
                focusTime,
                breakTime,
                longBreakTime,
                sessionsUntilLongBreak,
                autoApply: autoApplyCheckbox.checked,
                theme: document.body.className,
                isFullscreen: isFullscreen,
                selectedAlarmSound: selectedAlarmSound,
                lastReminderTime: lastReminderTime,
                lastSave: new Date().toISOString()
            };
            
            localStorage.setItem('pomodoram_data', JSON.stringify(data));
        }
        
        function loadFromLocalStorage() {
            const dataJson = localStorage.getItem('pomodoram_data');
            
            if (dataJson) {
                try {
                    const data = JSON.parse(dataJson);
                    
                    totalPomodoros = data.totalPomodoros || 0;
                    focusTimeToday = data.focusTimeToday || 0;
                    breakTimeToday = data.breakTimeToday || 0;
                    tasksCompleted = data.tasksCompleted || 0;
                    pomodoroCount = data.pomodoroCount || 0;
                    treeStage = data.treeStage || 0;
                    currentMode = data.currentMode || 'focus';
                    
                    // Load timer settings
                    if (data.focusTime) focusTime = data.focusTime;
                    if (data.breakTime) breakTime = data.breakTime;
                    if (data.longBreakTime) longBreakTime = data.longBreakTime;
                    if (data.sessionsUntilLongBreak) sessionsUntilLongBreak = data.sessionsUntilLongBreak;
                    
                    // Load settings
                    if (data.autoApply !== undefined) {
                        autoApplyCheckbox.checked = data.autoApply;
                    }
                    
                    // Load theme
                    if (data.theme) {
                        document.body.className = data.theme;
                        themeButtons.forEach(btn => {
                            btn.classList.remove('active');
                            if (btn.dataset.theme === data.theme.replace('-theme', '')) {
                                btn.classList.add('active');
                            }
                        });
                    }
                    
                    // Load alarm sound
                    if (data.selectedAlarmSound) selectedAlarmSound = data.selectedAlarmSound;
                    if (data.lastReminderTime) lastReminderTime = data.lastReminderTime;
                    
                    // Load fullscreen state
                    if (data.isFullscreen) {
                        setTimeout(() => {
                            enterFullscreen();
                        }, 100);
                    }
                    
                    // Load tasks
                    const tasksJson = localStorage.getItem('pomodoram_tasks');
                    if (tasksJson) {
                        const tasks = JSON.parse(tasksJson);
                        tasksCompleted = tasks.filter(task => task.completed).length;
                    }
                    
                    console.log("Loaded from localStorage successfully");
                } catch (e) {
                    console.error("Error loading from localStorage:", e);
                }
            } else {
                // Default values
                timeLeft = focusTime;
            }
        }
        
        // ==================== INITIALIZE ====================
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
